
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A Functional machine learning library for fast, visual, and parameter-driven modeling.">
      
      
      
      
        <link rel="prev" href="../../modeling/regression/">
      
      
        <link rel="next" href="../classification/">
      
      
        
      
      
      <link rel="icon" href="../../assets/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>Exploratory - BATWING ML LIBRARY</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.618322db.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CJetBrains+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"JetBrains Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="teal">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#exploratory-etl-api" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="BATWING ML LIBRARY" class="md-header__button md-logo" aria-label="BATWING ML LIBRARY" data-md-component="logo">
      
  <img src="../../assets/logo-light.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            BATWING ML LIBRARY
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Exploratory
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="teal"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="teal"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/Harshithan07/Batwing_ML_Library" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    batwing-ml-library
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../getting-started/" class="md-tabs__link">
        
  
  
    
  
  Getting Started

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../guides/classification-workflow/" class="md-tabs__link">
          
  
  
  Guides

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../data-and-exploration/data-validation-etl/" class="md-tabs__link">
          
  
  
  Data & Exploration

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../modeling/binary-classification/" class="md-tabs__link">
          
  
  
  Modeling

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="./" class="md-tabs__link">
          
  
  
  API Reference

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="BATWING ML LIBRARY" class="md-nav__button md-logo" aria-label="BATWING ML LIBRARY" data-md-component="logo">
      
  <img src="../../assets/logo-light.png" alt="logo">

    </a>
    BATWING ML LIBRARY
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Harshithan07/Batwing_ML_Library" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    batwing-ml-library
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Getting Started
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Guides
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Guides
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/classification-workflow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tabular Classification
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/regression-workflow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Regression
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/large-datasets-and-fast-mode/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Large Datasets & Fast Mode
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/notebooks-and-visual-previews/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Notebooks & Visual Previews
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Data & Exploration
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Data & Exploration
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-and-exploration/data-validation-etl/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Data Validation & ETL
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-and-exploration/sampling-and-splitting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Sampling & Splitting
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-and-exploration/summaries-and-profiling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Summaries & Profiling
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-and-exploration/preprocessing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Preprocessing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-and-exploration/feature-exploration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Feature Exploration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-and-exploration/feature-engineering/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Feature Engineering
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Modeling
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Modeling
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modeling/binary-classification/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Binary Classification
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modeling/multiclass-classification/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Multiclass Classification
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modeling/regression/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Regression
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    API Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    API Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Exploratory
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Exploratory
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#data-validation-etl" class="md-nav__link">
    <span class="md-ellipsis">
      
        Data validation &amp; ETL
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#batwing_ml.validate_and_clean_data" class="md-nav__link">
    <span class="md-ellipsis">
      
        validate_and_clean_data
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="validate_and_clean_data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#batwing_ml.validate_and_clean_data--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Parameters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#batwing_ml.validate_and_clean_data--returns" class="md-nav__link">
    <span class="md-ellipsis">
      
        Returns
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#batwing_ml.validate_and_clean_data--examples" class="md-nav__link">
    <span class="md-ellipsis">
      
        Examples
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#batwing_ml.validate_and_clean_data--notes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Notes
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#batwing_ml.validate_and_clean_data--related" class="md-nav__link">
    <span class="md-ellipsis">
      
        Related
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-preparation-splitting" class="md-nav__link">
    <span class="md-ellipsis">
      
        Data preparation &amp; splitting
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#batwing_ml.prepare_sample_split" class="md-nav__link">
    <span class="md-ellipsis">
      
        prepare_sample_split
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="prepare_sample_split">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#batwing_ml.prepare_sample_split--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Parameters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#batwing_ml.prepare_sample_split--returns" class="md-nav__link">
    <span class="md-ellipsis">
      
        Returns
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#batwing_ml.prepare_sample_split--examples" class="md-nav__link">
    <span class="md-ellipsis">
      
        Examples
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#batwing_ml.prepare_sample_split--notes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Notes
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#batwing_ml.prepare_sample_split--related" class="md-nav__link">
    <span class="md-ellipsis">
      
        Related
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dataframe-column-summaries" class="md-nav__link">
    <span class="md-ellipsis">
      
        DataFrame &amp; column summaries
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#batwing_ml.summary_dataframe" class="md-nav__link">
    <span class="md-ellipsis">
      
        summary_dataframe
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="summary_dataframe">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#batwing_ml.summary_dataframe--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Parameters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#batwing_ml.summary_dataframe--returns" class="md-nav__link">
    <span class="md-ellipsis">
      
        Returns
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#batwing_ml.summary_dataframe--raises" class="md-nav__link">
    <span class="md-ellipsis">
      
        Raises
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#batwing_ml.summary_dataframe--examples" class="md-nav__link">
    <span class="md-ellipsis">
      
        Examples
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#batwing_ml.summary_dataframe--notes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Notes
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#batwing_ml.summary_dataframe--see-also" class="md-nav__link">
    <span class="md-ellipsis">
      
        See Also
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#batwing_ml.summary_dataframe--user-guide" class="md-nav__link">
    <span class="md-ellipsis">
      
        User Guide
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#batwing_ml.summary_column" class="md-nav__link">
    <span class="md-ellipsis">
      
        summary_column
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="summary_column">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#batwing_ml.summary_column--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Parameters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#batwing_ml.summary_column--returns" class="md-nav__link">
    <span class="md-ellipsis">
      
        Returns
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#batwing_ml.summary_column--raises" class="md-nav__link">
    <span class="md-ellipsis">
      
        Raises
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#batwing_ml.summary_column--examples" class="md-nav__link">
    <span class="md-ellipsis">
      
        Examples
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#batwing_ml.summary_column--notes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Notes
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#batwing_ml.summary_column--see-also" class="md-nav__link">
    <span class="md-ellipsis">
      
        See Also
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#batwing_ml.summary_column--user-guide" class="md-nav__link">
    <span class="md-ellipsis">
      
        User Guide
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#preprocessing-helpers" class="md-nav__link">
    <span class="md-ellipsis">
      
        Preprocessing helpers
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#batwing_ml.preprocess_dataframe" class="md-nav__link">
    <span class="md-ellipsis">
      
        preprocess_dataframe
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="preprocess_dataframe">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#batwing_ml.preprocess_dataframe--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Parameters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#batwing_ml.preprocess_dataframe--returns" class="md-nav__link">
    <span class="md-ellipsis">
      
        Returns
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#batwing_ml.preprocess_dataframe--examples" class="md-nav__link">
    <span class="md-ellipsis">
      
        Examples
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#batwing_ml.preprocess_dataframe--notes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Notes
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#batwing_ml.preprocess_dataframe--see-also" class="md-nav__link">
    <span class="md-ellipsis">
      
        See Also
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#batwing_ml.preprocess_dataframe--user-guide" class="md-nav__link">
    <span class="md-ellipsis">
      
        User Guide
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#batwing_ml.preprocess_dataframe--related" class="md-nav__link">
    <span class="md-ellipsis">
      
        Related:
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#batwing_ml.preprocess_column" class="md-nav__link">
    <span class="md-ellipsis">
      
        preprocess_column
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="preprocess_column">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#batwing_ml.preprocess_column--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Parameters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#batwing_ml.preprocess_column--returns" class="md-nav__link">
    <span class="md-ellipsis">
      
        Returns
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#batwing_ml.preprocess_column--examples" class="md-nav__link">
    <span class="md-ellipsis">
      
        Examples
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#batwing_ml.preprocess_column--user-guide" class="md-nav__link">
    <span class="md-ellipsis">
      
        User Guide
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#batwing_ml.preprocess_column--related" class="md-nav__link">
    <span class="md-ellipsis">
      
        Related:
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#feature-exploration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Feature exploration
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#batwing_ml.feature_exploration" class="md-nav__link">
    <span class="md-ellipsis">
      
        feature_exploration
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#batwing_ml.feature_exploration.feature_exploration" class="md-nav__link">
    <span class="md-ellipsis">
      
        feature_exploration
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="feature_exploration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#batwing_ml.feature_exploration.feature_exploration--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Parameters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#batwing_ml.feature_exploration.feature_exploration--returns" class="md-nav__link">
    <span class="md-ellipsis">
      
        Returns
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#batwing_ml.feature_exploration.feature_exploration--examples" class="md-nav__link">
    <span class="md-ellipsis">
      
        Examples
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#batwing_ml.feature_exploration.feature_exploration--when-to-use" class="md-nav__link">
    <span class="md-ellipsis">
      
        When to Use
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#batwing_ml.feature_exploration.feature_exploration--notes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Notes
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#batwing_ml.feature_exploration.feature_exploration--related" class="md-nav__link">
    <span class="md-ellipsis">
      
        Related
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#feature-engineering" class="md-nav__link">
    <span class="md-ellipsis">
      
        Feature engineering
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#batwing_ml.feature_engineering" class="md-nav__link">
    <span class="md-ellipsis">
      
        feature_engineering
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#batwing_ml.feature_engineering.feature_engineering" class="md-nav__link">
    <span class="md-ellipsis">
      
        feature_engineering
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="feature_engineering">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#batwing_ml.feature_engineering.feature_engineering--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Parameters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#batwing_ml.feature_engineering.feature_engineering--returns" class="md-nav__link">
    <span class="md-ellipsis">
      
        Returns
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#batwing_ml.feature_engineering.feature_engineering--examples" class="md-nav__link">
    <span class="md-ellipsis">
      
        Examples
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#batwing_ml.feature_engineering.feature_engineering--notes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Notes
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#batwing_ml.feature_engineering.feature_engineering--see-also" class="md-nav__link">
    <span class="md-ellipsis">
      
        See Also
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../classification/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Classification
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../multiclass_classification/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Multiclass Classification
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../regression/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Regression
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="exploratory-etl-api">Exploratory &amp; ETL API</h1>
<p>This section documents the core utilities for data validation, sampling/splitting, EDA summaries, preprocessing, and feature engineering.</p>
<blockquote>
<p>Note: The <code>:::</code> blocks below are mkdocstrings hooks. If your module paths differ slightly,
adjust the dotted paths (e.g. <code>batwing_ml.something.module</code>) to match your actual package.</p>
</blockquote>
<hr />
<h2 id="data-validation-etl">Data validation &amp; ETL</h2>
<p>High-level entry point for cleaning and validating raw tabular data.</p>
<pre><code class="language-python">from batwing_ml import validate_and_clean_data
</code></pre>


<div class="doc doc-object doc-function">



<a id="batwing_ml.validate_and_clean_data"></a>
    <div class="doc doc-contents first">

        <p>Validate and clean a raw Pandas DataFrame with schema enforcement, common ETL transformations, 
and full audit logging — designed for production-ready ML pipelines and interactive data workflows.</p>
<p>This function performs all critical preprocessing validations:
- Ensures column names and data types are as expected
- Removes duplicates, trims and cleans strings
- Parses date columns, applies range/category checks
- Tracks actions in a structured report
- Optionally saves audit report as HTML and JSON</p>
<h3 id="batwing_ml.validate_and_clean_data--parameters">Parameters</h3>
<p>df : pd.DataFrame
    The raw input DataFrame to validate and clean. This should be the first step in your ML pipeline.</p>


<details class="schema-" open>
  <summary>dict, optional</summary>
  <p>A dictionary mapping expected column names to their expected pandas-compatible data types (e.g., 'int', 'float').
Used to coerce types using <code>.astype()</code> and flag columns that don't match.</p>
<p>Example:</p>
<blockquote>
<blockquote>
<blockquote>
<p>schema = {"age": "int", "income": "float", "signup_date": "datetime64[ns]"}</p>
</blockquote>
</blockquote>
</blockquote>
</details>

<details class="rename_map-" open>
  <summary>dict, optional</summary>
  <p>Dictionary to rename columns before validation. Useful when dealing with inconsistent column headers
from different data sources.</p>
<p>Example:</p>
<blockquote>
<blockquote>
<blockquote>
<p>rename_map = {"SignUpDate": "signup_date"}</p>
</blockquote>
</blockquote>
</blockquote>
</details>

<details class="deduplicate-" open>
  <summary>bool, default=True</summary>
  <p>If True, removes duplicate rows using <code>df.drop_duplicates()</code>. Duplicates removed are logged in the report.</p>
</details>

<details class="coerce_types-" open>
  <summary>bool, default=True</summary>
  <p>If True, attempts to cast each column to the type specified in the <code>schema</code>.
Safe conversions only; fails silently and skips invalid conversions.</p>
</details>

<details class="parse_dates-" open>
  <summary>bool, default=True</summary>
  <p>If True, automatically detects and parses columns that contain 'date' in their name using <code>pd.to_datetime()</code>.</p>
</details>

<details class="enforce_ranges-" open>
  <summary>dict, optional</summary>
  <p>A dictionary specifying numeric columns with acceptable (min, max) value ranges.
Rows violating the range are not dropped but counted and reported.</p>
<p>Example:</p>
<blockquote>
<blockquote>
<blockquote>
<p>enforce_ranges = {"age": (0, 120), "income": (0, 1_000_000)}</p>
</blockquote>
</blockquote>
</blockquote>
</details>

<details class="unique_columns-" open>
  <summary>list of str, optional</summary>
  <p>Columns that must contain unique values (e.g., primary keys). Violations are logged, not dropped.</p>
<p>Example:</p>
<blockquote>
<blockquote>
<blockquote>
<p>unique_columns = ["email", "user_id"]</p>
</blockquote>
</blockquote>
</blockquote>
</details>

<details class="category_constraints-" open>
  <summary>dict, optional</summary>
  <p>Dictionary mapping column names to a list of allowed values. Invalid category entries are flagged in the report.</p>
<p>Example:</p>
<blockquote>
<blockquote>
<blockquote>
<p>category_constraints = {"gender": ["male", "female", "other"]}</p>
</blockquote>
</blockquote>
</blockquote>
</details>

<details class="clean_strings-" open>
  <summary>bool, default=True</summary>
  <p>If True, strips leading/trailing spaces and lowercases all object-type (string) columns.</p>
</details>

<details class="snake_case_columns-" open>
  <summary>bool, default=True</summary>
  <p>If True, converts all column names to <code>snake_case</code> for consistency across downstream ML workflows.</p>
</details>

<details class="verbose-" open>
  <summary>bool, default=True</summary>
  <p>If True, prints basic progress logs to console. Does not affect HTML output.</p>
</details>

<details class="return_report-" open>
  <summary>bool, default=True</summary>
  <p>If True, displays a beautiful scrollable HTML summary in notebooks and returns the full metadata dictionary.</p>
</details>

<details class="report_path-" open>
  <summary>str, optional</summary>
  <p>File path to save the report as an <code>.html</code> file. Uses the same style as your notebook HTML output.</p>
<p>Example:</p>
<blockquote>
<blockquote>
<blockquote>
<p>report_path = "validation_report.html"</p>
</blockquote>
</blockquote>
</blockquote>
</details>

<details class="export_json-" open>
  <summary>str, optional</summary>
  <p>If provided, saves the full validation report dictionary as a <code>.json</code> file for use in audit pipelines, logging systems, etc.</p>
<p>Example:</p>
<blockquote>
<blockquote>
<blockquote>
<p>export_json = "validation_metadata.json"</p>
</blockquote>
</blockquote>
</blockquote>
</details>

<details class="pii_keywords-" open>
  <summary>list of str, optional</summary>
  <p>List of keywords (e.g., 'email', 'ssn', 'phone') to scan for in column names to flag potential PII fields.</p>
<p>Example:</p>
<blockquote>
<blockquote>
<blockquote>
<p>pii_keywords = ["email", "phone", "ssn"]</p>
</blockquote>
</blockquote>
</blockquote>
</details>        <h3 id="batwing_ml.validate_and_clean_data--returns">Returns</h3>
<p>df_clean : pd.DataFrame
    The cleaned and type-coerced DataFrame, safe for downstream modeling or transformation.</p>


<details class="report-" open>
  <summary>dict</summary>
  <p>A structured dictionary summarizing all validation checks, transformation steps, and column-level actions.
Contains keys such as: 'missing_values', 'coerced_columns', 'pii_suspects', etc.</p>
</details>        <h3 id="batwing_ml.validate_and_clean_data--examples">Examples</h3>
<p>▶️ Basic usage with report:</p>
<blockquote>
<blockquote>
<blockquote>
<p>df_clean, report = validate_and_clean_data(df, schema={"age": "int", "income": "float"})</p>
</blockquote>
</blockquote>
</blockquote>
<p>▶️ Add renaming and range checks:</p>
<blockquote>
<blockquote>
<blockquote>
<p>df_clean, report = validate_and_clean_data(
        df,
        rename_map={"SignUpDate": "signup_date"},
        enforce_ranges={"age": (0, 100)}
    )</p>
</blockquote>
</blockquote>
</blockquote>
<p>▶️ Generate downloadable audit report:</p>
<blockquote>
<blockquote>
<blockquote>
<p>validate_and_clean_data(
        df, schema=schema, report_path="validation.html", export_json="report.json"
    )</p>
</blockquote>
</blockquote>
</blockquote>
<h3 id="batwing_ml.validate_and_clean_data--notes">Notes</h3>
<ul>
<li>Columns not in schema are ignored during type coercion</li>
<li>Violations are logged but <strong>data is not dropped</strong> unless explicitly enabled</li>
<li>You can use this before any ML function like <code>preprocess_dataframe()</code> or <code>feature_engineering()</code></li>
<li>The audit report helps ensure trust, governance, and repeatability in data flows</li>
</ul>
<h3 id="batwing_ml.validate_and_clean_data--related">Related</h3>
<p>• preprocess_dataframe() – for full-scale modeling prep<br />
• feature_exploration() – for checking feature quality<br />
• prepare_sample_split() – for reproducible sampling/splitting<br />
• pandas_profiling (external) – for deep statistical reports<br />
• great_expectations (optional) – for declarative expectations</p>


    </div>

</div><hr />
<h2 id="data-preparation-splitting">Data preparation &amp; splitting</h2>
<p>Helpers for sampling and preparing train/val/test splits.</p>
<pre><code class="language-python">from batwing_ml import prepare_sample_split
</code></pre>


<div class="doc doc-object doc-function">



<a id="batwing_ml.prepare_sample_split"></a>
    <div class="doc doc-contents first">

        <p>Sample and/or split your dataset for training workflows with optional stratification, reproducibility, 
metadata tracking, and notebook-friendly summaries.</p>
<p>This function is ideal for:
- Efficiently working with large datasets by subsampling
- Creating reproducible train/test splits with or without class balance
- Getting audit-ready metadata (row counts, strategy used, seed)
- Easily integrating into notebook-based data science pipelines</p>
<h3 id="batwing_ml.prepare_sample_split--parameters">Parameters</h3>
<p>df : pd.DataFrame
    The full dataset from which sampling and/or splitting is performed. Each row is an observation.</p>


<details class="target-" open>
  <summary>str, optional</summary>
  <p>Column name to use for stratification (classification problems).
Required only if <code>stratify=True</code>. Can be ignored for regression tasks or unsupervised workflows.</p>
<p>Example:</p>
<blockquote>
<blockquote>
<blockquote>
<p>target='label'</p>
</blockquote>
</blockquote>
</blockquote>
</details>

<details class="sample_size-" open>
  <summary>int, optional</summary>
  <p>Number of rows to sample from the dataset before splitting.
If None, the entire dataset is used.</p>
<p>Example:</p>
<blockquote>
<blockquote>
<blockquote>
<p>sample_size=10000</p>
</blockquote>
</blockquote>
</blockquote>
</details>

<details class="split-" open>
  <summary>bool, default=False</summary>
  <p>Whether to split the sampled/full dataset into train and test sets.</p>
<p>If True, you get <code>(train_df, test_df)</code> or <code>(train_df, test_df, metadata)</code>.
If False, only a single DataFrame is returned.</p>
</details>

<details class="test_size-" open>
  <summary>float, default=0.2</summary>
  <p>Proportion of test set if <code>split=True</code>.</p>
<p>Example:</p>
<blockquote>
<blockquote>
<blockquote>
<p>test_size=0.3  # 70/30 split</p>
</blockquote>
</blockquote>
</blockquote>
</details>

<details class="stratify-" open>
  <summary>bool, default=False</summary>
  <p>If True, ensures that train/test (or sample) retains class balance by stratifying using the <code>target</code>.</p>
<p>Recommended for classification tasks.</p>
</details>

<details class="random_seed-" open>
  <summary>int, default=42</summary>
  <p>Sets the random state for both sampling and splitting to ensure full reproducibility.</p>
<p>Example:</p>
<blockquote>
<blockquote>
<blockquote>
<p>random_seed=123</p>
</blockquote>
</blockquote>
</blockquote>
</details>

<details class="return_indices-" open>
  <summary>bool, default=False</summary>
  <p>If True, returns the list of original indices of the sampled DataFrame.</p>
<p>Example:</p>
<blockquote>
<blockquote>
<blockquote>
<p>df_sampled, idx = prepare_sample_split(df, sample_size=5000, return_indices=True)</p>
</blockquote>
</blockquote>
</blockquote>
</details>

<details class="return_metadata-" open>
  <summary>bool, default=False</summary>
  <p>If True, returns a detailed dictionary summarizing:
- number of rows before/after sampling
- stratification status
- train/test split sizes (if split=True)
- random seed used</p>
<p>Metadata is also displayed in scrollable HTML format when using notebooks.</p>
</details>

<details class="verbose-" open>
  <summary>bool, default=False</summary>
  <p>If True, prints internal logging messages about the sampling/splitting process.</p>
</details>

<details class="log_callback-" open>
  <summary>callable, optional</summary>
  <p>Optional custom logging function (e.g., <code>logger.info</code>) to capture messages in logs or dashboards.</p>
<p>Example:</p>
<blockquote>
<blockquote>
<blockquote>
<p>prepare_sample_split(df, log_callback=my_logger)</p>
</blockquote>
</blockquote>
</blockquote>
</details>        <h3 id="batwing_ml.prepare_sample_split--returns">Returns</h3>
<p>pd.DataFrame or tuple
    - If <code>split=False</code>: returns a sampled <code>pd.DataFrame</code>, or with indices/metadata if requested.
    - If <code>split=True</code>: returns <code>(train_df, test_df)</code> or <code>(train_df, test_df, metadata)</code>.</p>
<h3 id="batwing_ml.prepare_sample_split--examples">Examples</h3>
<p>▶️ Basic sampling:</p>
<blockquote>
<blockquote>
<blockquote>
<p>df_sampled = prepare_sample_split(df, sample_size=5000)</p>
</blockquote>
</blockquote>
</blockquote>
<p>▶️ Sampling + splitting:</p>
<blockquote>
<blockquote>
<blockquote>
<p>train_df, test_df = prepare_sample_split(df, sample_size=10000, split=True)</p>
</blockquote>
</blockquote>
</blockquote>
<p>▶️ Stratified split with metadata:</p>
<blockquote>
<blockquote>
<blockquote>
<p>train_df, test_df, meta = prepare_sample_split(
        df, target='label', stratify=True, split=True, return_metadata=True
    )</p>
</blockquote>
</blockquote>
</blockquote>
<p>▶️ Sample with reproducibility:</p>
<blockquote>
<blockquote>
<blockquote>
<p>df_sampled = prepare_sample_split(df, sample_size=3000, random_seed=123)</p>
</blockquote>
</blockquote>
</blockquote>
<p>▶️ With logging hook:</p>
<blockquote>
<blockquote>
<blockquote>
<p>prepare_sample_split(df, log_callback=lambda msg: print(f"[LOG]: {msg}"))</p>
</blockquote>
</blockquote>
</blockquote>
<h3 id="batwing_ml.prepare_sample_split--notes">Notes</h3>
<ul>
<li>Internally uses <code>sklearn.model_selection.train_test_split()</code> for splitting and stratification.</li>
<li>Always resets index to prevent downstream issues with row alignment.</li>
<li>Stratification only works with classification-style discrete targets.</li>
</ul>
<h3 id="batwing_ml.prepare_sample_split--related">Related</h3>
<p>• feature_exploration() — run after sampling to analyze feature quality<br />
• evaluate_classification_model() — use after train/test split for performance metrics<br />
• feature_engineering() — to transform features post sampling/split<br />
• preprocess_dataframe() — clean the data before modeling</p>


    </div>

</div><hr />
<h2 id="dataframe-column-summaries">DataFrame &amp; column summaries</h2>
<p>Notebook-friendly EDA summaries for full DataFrames and individual columns.</p>
<pre><code class="language-python">from batwing_ml import summary_dataframe, summary_column
</code></pre>


<div class="doc doc-object doc-function">



<a id="batwing_ml.summary_dataframe"></a>
    <div class="doc doc-contents first">

        <p>Generates a detailed summary report of an entire DataFrame for exploratory data analysis (EDA).</p>
<p>This function provides a transparent, column-by-column overview of your dataset, including
data types, missing value patterns, uniqueness, cardinality, and optionally deeper
statistical insights like skewness, kurtosis, entropy, and correlation structure.</p>
<p>It helps you understand the shape and quality of your data before modeling, and supports
structured auditing via optional DataFrame outputs for downstream usage.</p>
<h3 id="batwing_ml.summary_dataframe--parameters">Parameters</h3>
<p>df : pd.DataFrame
    The input dataset to analyze. Must be a rectangular DataFrame with rows and columns.</p>


<details class="verbose-" open>
  <summary>bool, default=True</summary>
  <p>If True, prints human-readable summaries using styled tables, markdown, or HTML (in notebooks).
If <code>fast_mode=True</code>, this will be ignored (no prints will be shown).</p>
</details>

<details class="return_dataframes-" open>
  <summary>bool, default=False</summary>
  <p>If True, returns the core summary tables as pandas DataFrames for programmatic use.</p>
</details>

<details class="detailing-" open>
  <summary>bool, default=False</summary>
  <p>If True, enables additional statistics:
- For numeric: skewness, kurtosis, and z-score-based outlier counts
- For categorical: entropy (how evenly distributed the values are)
- Also shows duplicate row and column analysis</p>
</details>

<details class="correlation_matrix-" open>
  <summary>bool, default=False</summary>
  <p>If True, computes a Pearson correlation matrix for all numeric features.</p>
</details>

<details class="fast_mode-" open>
  <summary>bool, default=False</summary>
  <p>If True, disables all visual and computationally expensive diagnostics:
- Skips entropy, skewness, kurtosis, outliers, and duplicate detection
- Skips correlation matrix computation
- Skips verbose display/logging
Use this mode when profiling large datasets (e.g., 1M+ rows) or in batch workflows.</p>
</details>        <h3 id="batwing_ml.summary_dataframe--returns">Returns</h3>
<p>tuple of pd.DataFrame, optional
    Only returned if <code>return_dataframes=True</code>. Includes:
    - summary : Core metadata (dtype, missing %, unique %, etc.)
    - desc_numeric : Descriptive stats for all numeric columns
    - desc_categorical : Descriptive stats for categorical/object columns
    - correlation_matrix : Numeric correlation matrix (only if <code>correlation_matrix=True</code>)</p>
<h3 id="batwing_ml.summary_dataframe--raises">Raises</h3>
<p>ValueError
    If the input DataFrame is empty or not valid.</p>
<h3 id="batwing_ml.summary_dataframe--examples">Examples</h3>
<blockquote>
<blockquote>
<blockquote>
<p>summary_dataframe(df, detailing=True, correlation_matrix=True)</p>
<p>summary, num_stats, cat_stats = summary_dataframe(df, return_dataframes=True, detailing=True)</p>
</blockquote>
</blockquote>
</blockquote>
<h3 id="batwing_ml.summary_dataframe--notes">Notes</h3>
<ul>
<li>The function is non-destructive: it reads from the input DataFrame without modifying it.</li>
<li>If you're working with extremely large datasets, set <code>fast_mode=True</code> to avoid slow diagnostics.</li>
<li>When <code>verbose=True</code>, this function uses IPython’s HTML renderer for a notebook-friendly display.</li>
</ul>
<h3 id="batwing_ml.summary_dataframe--see-also">See Also</h3>
<p>summary_column : Analyze a single column with detailed metrics and plots
preprocess_dataframe : Prepare a dataset for modeling through scaling, encoding, and imputation
preprocess_column : Clean a single column manually (e.g., outlier handling, transformation)</p>
<h3 id="batwing_ml.summary_dataframe--user-guide">User Guide</h3>
<p>🧠 When Should You Use This?
- At the start of a project to assess <strong>data readiness</strong>.
- Before feature engineering to identify <strong>columns to drop, fix, or transform</strong>.
- During EDA or notebook exploration to communicate <strong>data quality</strong>.
- In automated pipelines where you need <strong>programmatic summary outputs</strong>.</p>
<p>📌 What You'll Learn:
- Which columns have high missingness, low variance, or high cardinality
- How many numeric/categorical features exist
- Skewness or entropy in features (if detailing=True)
- Whether your dataset has duplicated rows or columns
- Correlation patterns among numeric features (optional)</p>
<p>⚙️ Recommended Usage Patterns:</p>
<ol>
<li>
<p><strong>Full EDA diagnostic (notebooks):</strong></p>
<blockquote>
<blockquote>
<blockquote>
<p>summary_dataframe(df, detailing=True, correlation_matrix=True)</p>
</blockquote>
</blockquote>
</blockquote>
</li>
<li>
<p><strong>For dashboards or programmatic reporting:</strong></p>
<blockquote>
<blockquote>
<blockquote>
<p>summary, num_stats, cat_stats = summary_dataframe(df, return_dataframes=True)</p>
</blockquote>
</blockquote>
</blockquote>
</li>
<li>
<p><strong>Batch analysis or large files:</strong></p>
<blockquote>
<blockquote>
<blockquote>
<p>summary_dataframe(df, fast_mode=True)</p>
</blockquote>
</blockquote>
</blockquote>
</li>
<li>
<p><strong>Minimal quick check (CLI or scripts):</strong></p>
<blockquote>
<blockquote>
<blockquote>
<p>summary_dataframe(df, detailing=False, verbose=True)</p>
</blockquote>
</blockquote>
</blockquote>
</li>
</ol>
<p>💡 Tips:
- Use with <code>preprocess_dataframe()</code> to act on low-quality features you identify here.
- <code>entropy</code> close to 0 → one category dominates (low information)
- High skew/kurtosis → consider log or robust transformations
- Z-score outliers &gt;10 → column likely needs clipping or scaling
- Use <code>fast_mode=True</code> when processing high-volume datasets or in production loops.
- Use <code>detailing=False</code> for a quick overview of the dataset without deep stats.
- Use <code>correlation_matrix=False</code> to skip the correlation matrix.
- Use <code>return_dataframes=True</code> to export summaries to reports or ML audit logs</p>


    </div>

</div>

<div class="doc doc-object doc-function">



<a id="batwing_ml.summary_column"></a>
    <div class="doc doc-contents first">

        <p>Generates a detailed, human-readable summary of a single column in a DataFrame.</p>
<p>This function helps you understand the nature of a specific column by providing
summary metrics such as missingness, uniqueness, cardinality, entropy, skewness,
and optional visualizations. It adapts intelligently to both numeric and categorical data
and can highlight distribution issues, outliers, or missing trends over time.</p>
<p>It is ideal for exploratory data analysis (EDA), column-wise diagnostics, and
auditing feature quality before preprocessing or modeling.</p>
<h3 id="batwing_ml.summary_column--parameters">Parameters</h3>
<p>df : pd.DataFrame
    The DataFrame containing the column to summarize.</p>


<details class="column_name-" open>
  <summary>str</summary>
  <p>The name of the column to analyze.</p>
</details>

<details class="top_n-" open>
  <summary>int, default=10</summary>
  <p>Number of most frequent values to display in the frequency table for categorical features.</p>
</details>

<details class="verbose-" open>
  <summary>bool, default=True</summary>
  <p>If True, prints all summaries in formatted tables with headers. If <code>fast_mode=True</code>, this is ignored.</p>
</details>

<details class="return_dataframes-" open>
  <summary>bool, default=False</summary>
  <p>If True, returns:
- summary_table : key metrics (missing %, unique %, etc.)
- desc_stats : descriptive stats (mean, std, IQR, etc.)
- freq_dist : frequency counts of top values</p>
</details>

<details class="detailing-" open>
  <summary>bool, default=True</summary>
  <p>If True, enables additional diagnostics:
- For numeric: skewness, kurtosis, z-score outliers
- For categorical: entropy
- Also enables visualizations if <code>plots</code> is specified</p>
</details>

<details class="time_column-" open>
  <summary>str, optional</summary>
  <p>If specified, enables a missing-value trend chart over time using this datetime column.
Useful for temporal datasets and time-series analysis.</p>
</details>

<details class="plots-" open>
  <summary>list of str, optional</summary>
  <p>List of plots to display:
- "histogram": for numeric distribution
- "bar": for top category counts
- "missing_trend": for missing rate over time (requires <code>time_column</code>)</p>
</details>

<details class="fast_mode-" open>
  <summary>bool, default=False</summary>
  <p>If True, skips all optional visualizations, skew/entropy calculations, and pretty print tables.
Recommended when analyzing very large datasets or when integrating into production pipelines.</p>
</details>        <h3 id="batwing_ml.summary_column--returns">Returns</h3>
<p>tuple of pd.DataFrame, optional
    If <code>return_dataframes=True</code>, returns:
    - summary_table : base profile of the column
    - desc_stats : statistical or categorical description
    - freq_dist : top-N frequency breakdown</p>
<h3 id="batwing_ml.summary_column--raises">Raises</h3>
<p>ValueError
    If the specified column does not exist in the DataFrame.</p>
<h3 id="batwing_ml.summary_column--examples">Examples</h3>
<blockquote>
<blockquote>
<blockquote>
<p>summary_column(df, "salary", detailing=True, plots=["histogram"])</p>
<p>col_stats, desc, top_vals = summary_column(
        df,
        "product_category",
        detailing=True,
        plots=["bar"],
        return_dataframes=True
    )</p>
<p>summary_column(df, "discount", fast_mode=True)</p>
</blockquote>
</blockquote>
</blockquote>
<h3 id="batwing_ml.summary_column--notes">Notes</h3>
<ul>
<li>The function detects whether the column is numeric or categorical and adapts its metrics accordingly.</li>
<li>Outlier detection (z-score) is only applied to numeric features with sufficient variance.</li>
<li>Plots are automatically skipped when <code>fast_mode=True</code>.</li>
</ul>
<h3 id="batwing_ml.summary_column--see-also">See Also</h3>
<p>summary_dataframe : Summarizes all columns of a DataFrame at once.
preprocess_column : Cleans and transforms a single column based on rules.
preprocess_dataframe : End-to-end preprocessing pipeline for the entire DataFrame.</p>
<h3 id="batwing_ml.summary_column--user-guide">User Guide</h3>
<p>🧠 When Should You Use This?
- You want to audit or explore one column in depth.
- You're deciding how to impute, encode, or drop a specific column.
- You want to visualize category frequency or numeric distribution interactively.
- You're building an automated column-report pipeline (with return_dataframes=True).</p>
<p>⚙️ Recommended Use Cases</p>
<ol>
<li>
<p><strong>Understand a numeric column with outliers:</strong></p>
<blockquote>
<blockquote>
<blockquote>
<p>summary_column(df, "loan_amount", detailing=True, plots=["histogram"])</p>
</blockquote>
</blockquote>
</blockquote>
</li>
<li>
<p><strong>Explore a categorical feature for feature engineering:</strong></p>
<blockquote>
<blockquote>
<blockquote>
<p>summary_column(df, "device_type", top_n=5, detailing=True, plots=["bar"])</p>
</blockquote>
</blockquote>
</blockquote>
</li>
<li>
<p><strong>Check for seasonal missingness (e.g., sensors or logs):</strong></p>
<blockquote>
<blockquote>
<blockquote>
<p>summary_column(df, "temperature", time_column="timestamp", plots=["missing_trend"])</p>
</blockquote>
</blockquote>
</blockquote>
</li>
<li>
<p><strong>Automation or fast analysis at scale:</strong></p>
<blockquote>
<blockquote>
<blockquote>
<p>summary_column(df, "user_age", fast_mode=True)</p>
</blockquote>
</blockquote>
</blockquote>
</li>
</ol>
<p>💡 Tips:
- Use with <code>preprocess_column()</code> to apply encoding or transformation after diagnosis.
- If <code>entropy</code> is very low, the column may have little signal or be constant.
- use 'fast_mode'=True<code>for large datasets to skip slow diagnostics.
- Use</code>detailing=False<code>for a quick overview of the column without deep stats.
- For many zero-variance columns, use</code>summary_dataframe()<code>for batch detection.
- Always use</code>return_dataframes=True` if building custom reports or logging stats.</p>


    </div>

</div><hr />
<h2 id="preprocessing-helpers">Preprocessing helpers</h2>
<p>High-level preprocessing utilities that handle imputation, encoding, scaling, and column cleanup.</p>
<pre><code class="language-python">from batwing_ml import preprocess_dataframe, preprocess_column
</code></pre>


<div class="doc doc-object doc-function">



<a id="batwing_ml.preprocess_dataframe"></a>
    <div class="doc doc-contents first">

        <p>Preprocess a tabular dataset for machine learning using a streamlined, transparent pipeline.</p>
<p>This function performs automatic and configurable preprocessing on a pandas DataFrame, 
applying common transformations such as missing value imputation, categorical encoding, 
numeric feature scaling, and filtering of low-information or problematic features.</p>
<p>It is designed to make raw datasets "model-ready" with minimal manual effort,
while still allowing for full control over each preprocessing step.</p>
<h3 id="batwing_ml.preprocess_dataframe--parameters">Parameters</h3>
<p>df : pd.DataFrame
    The raw input dataset to preprocess. Must be a standard, rectangular DataFrame.</p>


<details class="impute-" open>
  <summary>bool, default=True</summary>
  <p>If True, fills missing values using the specified <code>numeric_method</code> and <code>categorical_method</code>.</p>
</details>

<details class="numeric_method-" open>
  <summary>{'mean', 'median', 'constant'}, default='mean'</summary>
  <p>Strategy to fill missing values in numeric columns:
- 'mean': use column average
- 'median': use column median
- 'constant': fill with 0</p>
</details>

<details class="categorical_method-" open>
  <summary>{'mode', 'constant', 'drop'}, default='mode'</summary>
  <p>Strategy to fill missing values in categorical columns:
- 'mode': fill with most frequent category
- 'constant': fill with "missing"
- 'drop': skip imputation for categoricals</p>
</details>

<details class="drop_missing_thresh-" open>
  <summary>float, default=0.3</summary>
  <p>Drop columns with more than this proportion of missing values (e.g., 0.3 = 30%).</p>
</details>

<details class="encode-" open>
  <summary>{'onehot', 'ordinal', None}, default='onehot'</summary>
  <p>How to encode categorical columns:
- 'onehot': expand categories into binary columns (ideal for tree-based and linear models)
- 'ordinal': convert categories into integers (compact but model-sensitive)
- None: skip encoding</p>
</details>

<details class="scale-" open>
  <summary>{'standard', 'minmax', 'robust', None}, default='standard'</summary>
  <p>Scaling method for numeric features:
- 'standard': zero mean, unit variance (default for most ML models)
- 'minmax': scales features to [0, 1]
- 'robust': scales using median and IQR (more resistant to outliers)
- None: skip scaling</p>
</details>

<details class="drop_constant-" open>
  <summary>bool, default=True</summary>
  <p>If True, drops columns where all values are the same — these provide no predictive value.</p>
</details>

<details class="max_cardinality-" open>
  <summary>int or None, default=100</summary>
  <p>If set, drops categorical columns with more than this many unique values.
Useful to eliminate IDs or high-entropy features that aren't generalizable.</p>
</details>

<details class="return_steps-" open>
  <summary>bool, default=False</summary>
  <p>If True, returns a second object (<code>steps</code>) summarizing the preprocessing pipeline steps.
This is useful for auditing, documentation, or reproducing pipelines.</p>
</details>

<details class="preview-" open>
  <summary>bool, default=False</summary>
  <p>If True, displays a styled scrollable HTML preview of the top rows of the transformed DataFrame.
Intended for use inside notebooks (e.g., Jupyter, Colab).</p>
</details>

<details class="verbose-" open>
  <summary>bool, default=True</summary>
  <p>If True, prints human-readable logs describing each transformation as it is applied.</p>
</details>

<details class="fast_mode-" open>
  <summary>bool, default=False</summary>
  <p>If True, disables logging and previews to optimize performance for large datasets (1M+ rows).
Recommended for production or batch processing pipelines.</p>
</details>        <h3 id="batwing_ml.preprocess_dataframe--returns">Returns</h3>
<p>pd.DataFrame or Tuple[pd.DataFrame, dict]
    - The transformed DataFrame, ready for use in ML models.
    - If <code>return_steps=True</code>, also returns a dictionary-like object listing:
        - dropped columns (due to high missingness, constant value, or high cardinality)
        - columns encoded, scaled, or imputed
        - final column names</p>
<h3 id="batwing_ml.preprocess_dataframe--examples">Examples</h3>
<blockquote>
<blockquote>
<blockquote>
<p>df_clean = preprocess_dataframe(df)</p>
<p>df_clean, steps = preprocess_dataframe(
        df,
        encode="ordinal",
        scale="robust",
        drop_missing_thresh=0.25,
        return_steps=True,
        preview=True
    )
print(steps)</p>
</blockquote>
</blockquote>
</blockquote>
<h3 id="batwing_ml.preprocess_dataframe--notes">Notes</h3>
<ul>
<li>This function does not modify the input DataFrame (works on a copy).</li>
<li>Designed to be flexible enough for prototyping, reproducible for experiments,
  and fast enough for production workloads.</li>
<li>Use <code>fast_mode=True</code> when processing high-volume datasets or in production loops.</li>
<li>For column-wise control, see <code>preprocess_column()</code>.</li>
</ul>
<h3 id="batwing_ml.preprocess_dataframe--see-also">See Also</h3>
<p>preprocess_column : Clean and transform a single Series with similar options.</p>
<h3 id="batwing_ml.preprocess_dataframe--user-guide">User Guide</h3>
<p>🧭 When Should You Use This Function?
- You're starting with raw, messy tabular data that has missing values, mixed data types, or irrelevant columns.
- You want to transform the dataset into a clean, numerical form ready for modeling — without hardcoding pipelines manually.
- You're preparing data for machine learning algorithms (scikit-learn, XGBoost, LightGBM, etc.) and need a reproducible cleaning strategy.
- You're in an experimentation phase and want fast iteration with logs, or you're moving toward deployment and need performance mode.</p>
<p>⚙️ Recommended Configurations (Use-Case Based)</p>
<ol>
<li><strong>General-purpose ML modeling (balanced tabular data):</strong>
   → Works well with logistic regression, SVMs, and shallow neural networks.<blockquote>
<blockquote>
<blockquote>
<p>preprocess_dataframe(df, encode="onehot", scale="standard")</p>
</blockquote>
</blockquote>
</blockquote>
</li>
</ol>
<p><em>Why?</em> One-hot encoding ensures categorical variables are treated independently. Standard scaling helps models converge.</p>
<ol>
<li><strong>Tree-based models (RandomForest, XGBoost, LightGBM):</strong>
   → These models handle ordinal input well and don’t require scaling.<blockquote>
<blockquote>
<blockquote>
<p>preprocess_dataframe(df, encode="ordinal", scale=None)</p>
</blockquote>
</blockquote>
</blockquote>
</li>
</ol>
<p><em>Why?</em> One-hot can add noise or bloat tree-based models. Ordinal + no scaling is faster and sufficient.</p>
<ol>
<li><strong>High-cardinality datasets or sparse data (e.g., recommender systems):</strong><blockquote>
<blockquote>
<blockquote>
<p>preprocess_dataframe(df, encode=None, max_cardinality=50)</p>
</blockquote>
</blockquote>
</blockquote>
</li>
</ol>
<p><em>Why?</em> Skip encoding and limit high-cardinality columns to avoid exploding the feature space.</p>
<ol>
<li><strong>Production or big data batch preprocessing:</strong>
   → Great for pipelines where performance &gt; visuals.<blockquote>
<blockquote>
<blockquote>
<p>preprocess_dataframe(df, fast_mode=True)</p>
</blockquote>
</blockquote>
</blockquote>
</li>
</ol>
<p><em>Why?</em> Disables all logging and display overhead — ideal for 1M+ rows.</p>
<ol>
<li><strong>Auditing or debugging preprocessing behavior:</strong>
   → You want to know exactly what was changed and why.<blockquote>
<blockquote>
<blockquote>
<p>df_clean, steps = preprocess_dataframe(df, return_steps=True, verbose=True)
print(steps)</p>
</blockquote>
</blockquote>
</blockquote>
</li>
</ol>
<p><em>Why?</em> <code>steps</code> logs dropped columns, encoded features, and final output — great for versioning and reproducibility.</p>
<p>💡 Tips:
- Use <code>preview=True</code> only in notebooks to visualize output cleanly.
- Set <code>max_cardinality=None</code> to retain all categorical columns, even high-card ones.
- <code>drop_constant=True</code> removes junk features automatically.
- Use <code>fast_mode=True</code> when processing high-volume datasets or in production loops.
- Use <code>preprocess_column()</code> for detailed tuning on a single feature.</p>
<h3 id="batwing_ml.preprocess_dataframe--related">Related:</h3>
<p>• preprocess_column(): Clean and transform a single Series with similar options.
• summary_column(): View deep stats for a single column before preprocessing
• summary_dataframe(): View deep stats for a DataFrame before preprocessing</p>


    </div>

</div>

<div class="doc doc-object doc-function">



<a id="batwing_ml.preprocess_column"></a>
    <div class="doc doc-contents first">

        <p>Preprocess a single column of data with smart transformations for modeling.</p>
<p>This function allows targeted preprocessing of a single pandas Series — such as a feature column
from a DataFrame — including missing value imputation, outlier treatment, encoding, scaling, 
custom transformations, and optional inspection via plots or previews.</p>
<p>It is useful for exploratory analysis, fine-tuned feature engineering, or inspecting
column-specific cleaning steps outside of full-pipeline automation.</p>
<h3 id="batwing_ml.preprocess_column--parameters">Parameters</h3>
<p>col : pd.Series
    The input column to clean. Can be numeric or categorical.</p>


<details class="impute-" open>
  <summary>{'mean', 'median', 'mode', 'constant'} or scalar, optional</summary>
  <p>Strategy to fill missing values:
- 'mean', 'median': numeric only
- 'mode': most frequent value (works for both types)
- 'constant': fill with 0 or "missing"
- scalar: fill with a specific value (e.g., 0 or 'unknown')</p>
</details>

<details class="scale-" open>
  <summary>{'standard', 'minmax', 'robust'}, optional</summary>
  <p>If provided, applies scaling (numeric only):
- 'standard': zero mean, unit variance
- 'minmax': rescale to [0, 1]
- 'robust': scale based on median and IQR (for outliers)</p>
</details>

<details class="encode-" open>
  <summary>{'ordinal', 'onehot'}, optional</summary>
  <p>If provided, applies encoding (categorical only):
- 'ordinal': converts categories to integer codes
- 'onehot': returns a new DataFrame with binary indicator columns</p>
</details>

<details class="cap_outliers-" open>
  <summary>{'zscore', 'iqr'}, optional</summary>
  <p>Method for outlier detection and clipping (numeric only):
- 'zscore': clips values with |Z| &gt; 3
- 'iqr': clips values outside 1.5 * IQR from Q1/Q3</p>
</details>

<details class="cap_quantiles-" open>
  <summary>tuple of float, default=(0.01, 0.99)</summary>
  <p>Lower and upper quantiles to cap values (a form of Winsorization).
Applied only for numeric columns.</p>
</details>

<details class="custom_map-" open>
  <summary>callable, optional</summary>
  <p>A custom function applied to every non-null element (e.g., <code>np.log1p</code>, <code>str.lower</code>).
Useful for transformations like scaling, mapping, or normalization.</p>
</details>

<details class="strategy-" open>
  <summary>{'manual', 'auto'}, default='manual'</summary>
  <ul>
<li>'manual': use the specified arguments only</li>
<li>'auto': infer reasonable defaults based on column dtype and missing values</li>
</ul>
</details>

<details class="inplace-" open>
  <summary>bool, default=False</summary>
  <p>If True, modifies the original Series inside a DataFrame. Otherwise works on a copy.</p>
</details>

<details class="preview-" open>
  <summary>bool, default=False</summary>
  <p>If True, prints a small sample (head) of the cleaned column.</p>
</details>

<details class="plot-" open>
  <summary>bool, default=False</summary>
  <p>If True, shows a histogram or bar plot (before/after if possible) to visualize the distribution.</p>
</details>

<details class="verbose-" open>
  <summary>bool, default=True</summary>
  <p>If True, logs steps taken (e.g., imputed with mean, encoded with ordinal).</p>
</details>

<details class="fast_mode-" open>
  <summary>bool, default=False</summary>
  <p>If True, disables plotting and previews for faster execution on large data.</p>
</details>        <h3 id="batwing_ml.preprocess_column--returns">Returns</h3>
<p>pd.Series or Tuple[pd.Series, dict]
    - Cleaned Series (or one-hot encoded DataFrame if applicable).
    - If used in unpacking (<code>col_clean, steps = ...</code>), also returns a dictionary
      detailing the preprocessing actions taken.</p>
<h3 id="batwing_ml.preprocess_column--examples">Examples</h3>
<blockquote>
<blockquote>
<blockquote>
<p>col_clean = preprocess_column(df["age"], impute="mean", scale="standard")[0]</p>
<p>cat_col, steps = preprocess_column(
        df["gender"],
        impute="mode",
        encode="ordinal",
        preview=True,
        verbose=True
    )
print(steps)</p>
</blockquote>
</blockquote>
</blockquote>
<h3 id="batwing_ml.preprocess_column--user-guide">User Guide</h3>
<p>🧭 When Should You Use This?
- You want fine-grained control over a <strong>single column</strong> in your dataset — e.g., apply different transformations for different features.
- You’re doing <strong>exploratory data analysis</strong> and want to inspect the impact of transformations before applying them in batch.
- You’re manually curating a feature set for a model and want to test encoding, scaling, or outlier treatment interactively.
- You’re building a <strong>custom preprocessing function</strong> per column for pipelines.</p>
<p>⚙️ Recommended Workflows (Based on Column Type)</p>
<ol>
<li><strong>For numeric columns (e.g., age, income, price):</strong>
   Apply standard cleaning + scaling + clipping:<blockquote>
<blockquote>
<blockquote>
<p>col_clean, steps = preprocess_column(
           df["income"],
           impute="mean",
           scale="standard",
           cap_outliers="zscore",
           cap_quantiles=(0.01, 0.99),
           preview=True,
           plot=True
       )</p>
</blockquote>
</blockquote>
</blockquote>
</li>
</ol>
<p><em>Why?</em> Numeric data benefits from scaling and outlier handling for better model convergence.</p>
<ol>
<li><strong>For categorical columns (e.g., gender, city):</strong>
   Apply imputation and ordinal encoding:<blockquote>
<blockquote>
<blockquote>
<p>col_clean = preprocess_column(
           df["gender"],
           impute="mode",
           encode="ordinal"
       )[0]</p>
</blockquote>
</blockquote>
</blockquote>
</li>
</ol>
<p><em>Why?</em> Many models expect numeric input; ordinal encoding works well for tree models.</p>
<ol>
<li><strong>When exploring transformation effects:</strong>
   Use custom mapping functions or log transforms:<blockquote>
<blockquote>
<blockquote>
<p>preprocess_column(df["price"], custom_map=np.log1p, plot=True)</p>
</blockquote>
</blockquote>
</blockquote>
</li>
</ol>
<p><em>Why?</em> Helps reduce skew in price-like data, which improves linear model performance.</p>
<ol>
<li><strong>Quick automation:</strong>
   Let the function auto-decide how to handle the column:<blockquote>
<blockquote>
<blockquote>
<p>preprocess_column(df["feature_x"], strategy="auto")</p>
</blockquote>
</blockquote>
</blockquote>
</li>
</ol>
<p><em>Why?</em> Saves time when you’re cleaning many features quickly.</p>
<p>🔍 Tips:
- Use <code>preview=True</code> to view how the column looks after cleaning.
- Use <code>plot=True</code> to visualize distributions before/after transformations.
- Use <code>steps</code> output to document what happened to the column — especially useful in notebooks or reports.
- Use <code>fast_mode=True</code> when processing high-volume datasets or in production loops.
- One-hot encoding returns a DataFrame (not Series) — plan how you store or merge it back.</p>
<h3 id="batwing_ml.preprocess_column--related">Related:</h3>
<p>• preprocess_dataframe(): Clean an entire DataFrame in one call
• summary_column(): View deep stats for a single column before preprocessing
• summary_dataframe(): View deep stats for a DataFrame before preprocessing</p>


    </div>

</div><hr />
<h2 id="feature-exploration">Feature exploration</h2>
<p>Lightweight utilities to inspect feature-target relationships.</p>
<pre><code class="language-python">from batwing_ml import feature_exploration
</code></pre>


<div class="doc doc-object doc-module">



<a id="batwing_ml.feature_exploration"></a>
    <div class="doc doc-contents first">










  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h2 id="batwing_ml.feature_exploration.feature_exploration" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">feature_exploration</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">task</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">top_n</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">corr_threshold</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">skew_threshold</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">sample_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fast_mode</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">export_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tree_importance</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">perm_importance</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">show_preview</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_summary</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">heavy_ops_sample</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span> <span class="n">plots</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Quickly analyze the quality and behavior of your dataset's features, with rich statistical summaries,
automated warnings, optional modeling, and beautiful visualizations.</p>
<p>This function helps you discover:
- What features matter most for prediction?
- Which features are redundant or constant?
- Which columns may require transformation (e.g., skewed)?
- How do categorical features relate to the target?</p>
<p>Ideal for data scientists, analysts, and ML engineers who want to explore datasets before modeling.</p>
<h4 id="batwing_ml.feature_exploration.feature_exploration--parameters">Parameters</h4>
<p>df : pd.DataFrame
    The input dataset. Each column is treated as a potential feature.</p>
<pre><code>✅ Required: Must be a clean rectangular DataFrame (no nested structures).
</code></pre>


<details class="target-" open>
  <summary>str, optional</summary>
  <p>The name of the target (dependent) variable in your dataset.</p>
<p>Required for supervised diagnostics like:
- Mutual Information (MI)
- Correlation with target
- Tree-based feature importance
- Permutation importance
- Grouped statistics for categorical features</p>
<p>Example:</p>
<blockquote>
<blockquote>
<blockquote>
<p>target = "SalePrice"</p>
</blockquote>
</blockquote>
</blockquote>
</details>

<details class="task-" open>
  <summary>{'regression', 'classification', 'multiclass'}, optional</summary>
  <p>Type of ML problem:
- 'regression': Predicting continuous values (e.g., prices, temperature)
- 'classification': Binary prediction (e.g., spam or not spam)
- 'multiclass': More than 2 classes (e.g., sentiment = low/medium/high)</p>
<p>✅ If not passed, the function will auto-detect using target column data type and uniqueness.</p>
</details>

<details class="top_n-" open>
  <summary>int, default=20</summary>
  <p>How many top features to display in:
- Summary table
- Importance plots
- Skewed distribution visualizations</p>
<p>Tip: Increase to 50 or 100 for wide datasets with many features.</p>
</details>

<details class="corr_threshold-" open>
  <summary>float, default=0.95</summary>
  <p>Threshold above which two numeric features are considered highly correlated (redundant).</p>
<ul>
<li>Used to flag potential multicollinearity in the summary</li>
<li>Helps you decide which features might be dropped</li>
</ul>
<p>Example:
- A corr of 0.98 between 'age' and 'years_since_birth' may signal redundancy</p>
</details>

<details class="skew_threshold-" open>
  <summary>float, default=1.0</summary>
  <p>Skewness threshold for numeric features.</p>
<ul>
<li>Columns with absolute skew &gt; threshold are flagged</li>
<li>These may benefit from transformation like <code>log(x+1)</code> or power scaling</li>
</ul>
<p>Tip: Highly skewed features can reduce model performance (especially linear models).</p>
</details>

<details class="sample_size-" open>
  <summary>int, optional</summary>
  <p>If set, the DataFrame is sampled down to this number of rows before computing summaries.</p>
<p>Useful for:
- Large datasets (100k+ rows)
- Speeding up exploration
- Limiting memory usage</p>
<p>Example:</p>
<blockquote>
<blockquote>
<blockquote>
<p>sample_size = 10000</p>
</blockquote>
</blockquote>
</blockquote>
</details>

<details class="fast_mode-" open>
  <summary>bool, default=False</summary>
  <p>Turns off all compute-intensive operations:
- Mutual information
- Tree-based model fitting
- Permutation importance
- Plots</p>
<p>✅ Use this for quick diagnostics on very large datasets or inside pipelines.</p>
</details>

<details class="export_path-" open>
  <summary>str, optional</summary>
  <p>If set, saves the summary table as a CSV.</p>
<p>Example:</p>
<blockquote>
<blockquote>
<blockquote>
<p>export_path = "feature_summary.csv"</p>
</blockquote>
</blockquote>
</blockquote>
</details>

<details class="tree_importance-" open>
  <summary>bool, default=True</summary>
  <p>If enabled and target is provided:
- Fits a RandomForest model
- Extracts feature importances
- Displays top-N most predictive features</p>
<p>⚠️ Ignored if <code>fast_mode=True</code>.</p>
</details>

<details class="perm_importance-" open>
  <summary>bool, default=True</summary>
  <p>If enabled:
- Computes permutation-based feature importance (model-agnostic)
- More stable than tree importances</p>
<p>⚠️ Slower. Use only for small to mid-sized datasets or when needed.</p>
</details>

<details class="show_preview-" open>
  <summary>bool, default=True</summary>
  <p>Displays the output table in a scrollable, styled HTML block (dark-theme compatible).</p>
<p>Recommended for:
- Jupyter Notebook
- Google Colab
- VSCode notebooks</p>
</details>

<details class="return_summary-" open>
  <summary>bool, default=False</summary>
  <p>If True, the summary table (a DataFrame) is returned.</p>
<p>Useful when you want to:
- Save to Excel/CSV manually
- Merge with other reports
- Visualize in another tool</p>
</details>

<details class="heavy_ops_sample-" open>
  <summary>int, default=5000</summary>
  <p>For compute-heavy steps like model fitting, mutual info, or permutation:
- Only this many rows are sampled from the DataFrame</p>
<p>Keeps everything fast and memory-efficient.</p>
</details>

<details class="plots-" open>
  <summary>list of str, optional</summary>
  <p>List of visualizations to include. Choose any of:</p>
<ul>
<li>'importance': Bar plot of top features by tree or permutation importance</li>
<li>'correlation': Heatmap of correlation between numeric features</li>
<li>'skewed': Histogram of skewed numeric columns</li>
<li>'grouped': Bar plots of mean target by category (only for regression)</li>
</ul>
<p>Example:</p>
<blockquote>
<blockquote>
<blockquote>
<p>plots = ["importance", "correlation", "skewed"]</p>
</blockquote>
</blockquote>
</blockquote>
</details>        <h4 id="batwing_ml.feature_exploration.feature_exploration--returns">Returns</h4>
<p>pd.DataFrame or None
    - If <code>return_summary=True</code>: Returns a summary DataFrame with suggestions
    - If <code>return_summary=False</code>: Displays summary and plots only</p>
<h4 id="batwing_ml.feature_exploration.feature_exploration--examples">Examples</h4>
<p>▶️ Basic usage:</p>
<blockquote>
<blockquote>
<blockquote>
<p>feature_exploration(df, target="SalePrice", task="regression")</p>
</blockquote>
</blockquote>
</blockquote>
<p>▶️ With visuals and full scoring:</p>
<blockquote>
<blockquote>
<blockquote>
<p>feature_exploration(
        df,
        target="target",
        task="regression",
        plots=["importance", "correlation", "skewed", "grouped"]
    )</p>
</blockquote>
</blockquote>
</blockquote>
<p>▶️ Fast mode scan:</p>
<blockquote>
<blockquote>
<blockquote>
<p>feature_exploration(df, fast_mode=True)</p>
</blockquote>
</blockquote>
</blockquote>
<p>▶️ Export results:</p>
<blockquote>
<blockquote>
<blockquote>
<p>feature_exploration(df, target="target", export_path="summary.csv")</p>
</blockquote>
</blockquote>
</blockquote>
<p>▶️ Capture summary in a variable:</p>
<blockquote>
<blockquote>
<blockquote>
<p>summary_df = feature_exploration(df, return_summary=True)</p>
</blockquote>
</blockquote>
</blockquote>
<h4 id="batwing_ml.feature_exploration.feature_exploration--when-to-use">When to Use</h4>
<p>✅ Before modeling: to identify top features, poor features, or potential issues<br />
✅ After cleaning: to detect skew, high cardinality, or multicollinearity<br />
✅ In pipelines: to auto-generate feature insight reports<br />
✅ In dashboards: to track data quality in production  </p>
<h4 id="batwing_ml.feature_exploration.feature_exploration--notes">Notes</h4>
<ul>
<li>Correlation = Pearson for numeric features</li>
<li>Skewness is calculated using SciPy’s <code>skew()</code></li>
<li>Importance plots use RandomForest or Permutation models</li>
<li>Grouped stats only apply to regression targets and categorical features</li>
</ul>
<h4 id="batwing_ml.feature_exploration.feature_exploration--related">Related</h4>
<p>• feature_engineering() – to act on features after diagnosing<br />
• preprocess_dataframe() – for cleaning before feature exploration<br />
• summary_dataframe() – to get statistical overview of the full DataFrame<br />
• evaluate_classification_model() – to inspect how features affect model accuracy</p>


    </div>

</div>



  </div>

    </div>

</div><hr />
<h2 id="feature-engineering">Feature engineering</h2>
<p>Tools for feature selection, transformation, and dimensionality reduction.</p>
<pre><code class="language-python">from batwing_ml import feature_engineering
</code></pre>


<div class="doc doc-object doc-module">



<a id="batwing_ml.feature_engineering"></a>
    <div class="doc doc-contents first">










  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h2 id="batwing_ml.feature_engineering.feature_engineering" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">feature_engineering</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">task</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">apply_changes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">strategy</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">top_k</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fast_mode</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">show_preview</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_metadata</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">pca_components</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">clustering</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cluster_k</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cluster_feature_name</span><span class="o">=</span><span class="s1">&#39;cluster_label&#39;</span><span class="p">,</span> <span class="n">plots</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">selection_method</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">selection_threshold</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Perform automatic feature selection, engineering, and clustering in one unified function.</p>
<p>This function is built for data scientists, analysts, or ML engineers who want to streamline the
feature preprocessing pipeline with just one function call — while maintaining transparency, reproducibility,
and full control over what happens to their features.</p>
<h4 id="batwing_ml.feature_engineering.feature_engineering--parameters">Parameters</h4>
<p>df : pd.DataFrame
    The input dataset where each row is an observation and each column is a feature.
    This is the only required argument — all others are optional and context-dependent.</p>


<details class="target-" open>
  <summary>str, optional</summary>
  <p>The name of the target column (i.e., label or output variable).
This is necessary for supervised selection techniques like:
- Mutual Information (<code>mutual_info</code>)
- Model-based importance (<code>model</code>)
- Lasso regression (<code>lasso</code>)
- Recursive Feature Elimination (<code>rfe</code>)</p>
<p>⚠️ If you don't pass this, selection methods requiring supervision will be skipped.</p>
</details>

<details class="mode-" open>
  <summary>{'selection', 'engineering', 'both'}, default='both'</summary>
  <p>Controls what parts of the pipeline are executed:
- 'selection': Only selects features based on some criteria.
- 'engineering': Only adds new features (e.g., polynomial or PCA).
- 'both': Runs selection first, then engineering.</p>
<p>👉 Tip: Use 'selection' during early cleanup. Use 'engineering' later before modeling.</p>
</details>

<details class="task-" open>
  <summary>{'regression', 'classification'}, optional</summary>
  <p>Type of ML problem. If not specified, it will be inferred from <code>target</code>:
- Regression: If target is numeric with many unique values.
- Classification: If target is binary or categorical.</p>
<p>This controls scoring logic for feature selection (e.g., model choice, MI scoring).</p>
</details>

<details class="apply_changes-" open>
  <summary>bool, default=True</summary>
  <ul>
<li>True → Apply selection/engineering steps directly to the data.</li>
<li>False → Simulate the pipeline, only generate metadata and preview output.</li>
</ul>
<p>✅ Use <code>apply_changes=False</code> if you're testing or auditing steps first.</p>
</details>

<details class="strategy-" open>
  <summary>{'auto', 'manual'}, default='auto'</summary>
  <p>Controls engineering behavior:
- 'auto': Automatically applies PolynomialFeatures and PCA if context is appropriate.
- 'manual': Skip all engineering unless explicitly requested (e.g., you pass <code>pca_components</code>).</p>
</details>

<details class="top_k-" open>
  <summary>int, optional</summary>
  <p>Number of features to retain in methods like RFE or when displaying top-N importances.</p>
<p>📌 Useful if you want to aggressively reduce feature dimensionality.</p>
</details>

<details class="fast_mode-" open>
  <summary>bool, default=False</summary>
  <p>Enables performance-safe mode:
- Disables model fitting, plotting, clustering, and PCA.
- Ideal for large datasets or batch scripts.</p>
<p>⚠️ No importance plots or PCA will run if this is True.</p>
</details>

<details class="show_preview-" open>
  <summary>bool, default=True</summary>
  <p>Displays a styled scrollable table showing:
- Which features are kept
- Which are engineered
- Which were dropped</p>
<p>✔️ Highly recommended in Jupyter/Colab for visual tracking.</p>
</details>

<details class="return_metadata-" open>
  <summary>bool, default=True</summary>
  <p>If True, returns a <code>_FeatureEngineeringSteps</code> object summarizing what happened.</p>
<p>Contains:
- <code>selected_features</code>
- <code>dropped_features</code>
- <code>created_features</code>
- <code>transforms_applied</code></p>
</details>

<details class="pca_components-" open>
  <summary>int, optional</summary>
  <p>Number of Principal Components to add.
- Applies PCA on numeric features
- Useful for dimensionality reduction and multicollinearity handling</p>
<p>📊 If you add <code>"pca"</code> to <code>plots</code>, it shows a variance-explained curve.</p>
</details>

<details class="clustering-" open>
  <summary>bool, default=False</summary>
  <p>Enables KMeans clustering on numeric columns.</p>
<p>✅ Adds a new column (<code>cluster_feature_name</code>) to represent the assigned cluster.</p>
</details>

<details class="cluster_k-" open>
  <summary>int, optional</summary>
  <p>Number of clusters (k) to use.
- If None: shows elbow plot of SSE vs k.
- If set: assigns clusters directly.</p>
</details>

<details class="cluster_feature_name-" open>
  <summary>str, default='cluster_label'</summary>
  <p>Name of the column that stores the cluster number for each row.
You can rename this if you’re using multiple clustering passes.</p>
</details>

<details class="plots-" open>
  <summary>list of str, optional</summary>
  <p>Visualizations to generate (optional, ignored in fast mode):
- <code>"importance"</code>: Bar chart of top RandomForest importances
- <code>"pca"</code>: Line plot showing cumulative variance from PCA
- <code>"clusters"</code>: 2D PCA plot showing colored clusters</p>
<p>➕ Add one or more based on your workflow.</p>
</details>

<details class="selection_method-" open>
  <summary>str, optional</summary>
  <p>Method used for selecting features:
- 'variance' → Drops constant or low-variance features
- 'correlation' → Drops one of each highly correlated pair (based on threshold)
- 'mutual_info' → Mutual Information score against the target
- 'model' → Tree-based embedded feature importance (RandomForest)
- 'lasso' → Uses coefficients from Lasso regression (regression only)
- 'rfe' → Recursive Feature Elimination (Linear/Logistic)
- 'auto' → Auto-selects based on task (classification/regression)</p>
</details>

<details class="selection_threshold-" open>
  <summary>float, default=0.01</summary>
  <p>Threshold for filtering-based methods:
- If using <code>'correlation'</code>: Drop if abs(corr) &gt; threshold
- If using <code>'mutual_info'</code>: Keep if MI score &gt; threshold</p>
<p>📌 Lower values retain more features, higher values are stricter.</p>
</details>        <h4 id="batwing_ml.feature_engineering.feature_engineering--returns">Returns</h4>
<p>pd.DataFrame
    The transformed dataset with selected and engineered features.</p>
<p>_FeatureEngineeringSteps (if return_metadata=True)
    A rich summary of steps applied — for logs, reports, and audits.</p>
<h4 id="batwing_ml.feature_engineering.feature_engineering--examples">Examples</h4>
<p>▶️ Full pipeline:</p>
<blockquote>
<blockquote>
<blockquote>
<p>X, steps = feature_engineering(
        df=raw_df,
        target='target',
        mode='both',
        strategy='auto',
        selection_method='model',
        pca_components=3,
        clustering=True,
        cluster_k=5,
        plots=['importance', 'pca', 'clusters']
    )</p>
</blockquote>
</blockquote>
</blockquote>
<p>▶️ Dry run (no changes, just audit):</p>
<blockquote>
<blockquote>
<blockquote>
<p>X, log = feature_engineering(df, target='target', apply_changes=False)</p>
</blockquote>
</blockquote>
</blockquote>
<p>▶️ PCA for dimensionality reduction:</p>
<blockquote>
<blockquote>
<blockquote>
<p>X, meta = feature_engineering(df, mode='engineering', pca_components=2)</p>
</blockquote>
</blockquote>
</blockquote>
<p>▶️ Lightweight filter-based selection:</p>
<blockquote>
<blockquote>
<blockquote>
<p>X, meta = feature_engineering(df, target='target', mode='selection', selection_method='mutual_info')</p>
</blockquote>
</blockquote>
</blockquote>
<h4 id="batwing_ml.feature_engineering.feature_engineering--notes">Notes</h4>
<ul>
<li>Use <code>return_metadata=True</code> to track what changed — crucial for reproducibility.</li>
<li>Feature selection happens before feature creation.</li>
<li>All steps are logged and previewed before being applied.</li>
<li>PCA and clustering only work on numeric columns.</li>
</ul>
<h4 id="batwing_ml.feature_engineering.feature_engineering--see-also">See Also</h4>
<p>• feature_exploration() – For diagnostics before applying changes<br />
• preprocess_dataframe() – For imputation, encoding, and basic cleanup<br />
• summary_dataframe() – For an overview of raw features<br />
• evaluate_classification_model() – To measure final model quality</p>


    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
    <a href="https://github.com/Harshithan07" target="_blank" rel="noopener" title="GitHub" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
    <a href="https://www.linkedin.com/in/harshithan-ks/" target="_blank" rel="noopener" title="LinkedIn" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
    
    
    
    
    <a href="mailto:harshithan.ks2002@gmail.com" target="_blank" rel="noopener" title="Email" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M48 64C21.5 64 0 85.5 0 112c0 15.1 7.1 29.3 19.2 38.4l208 156a48 48 0 0 0 57.6 0l208-156c12.1-9.1 19.2-23.3 19.2-38.4 0-26.5-21.5-48-48-48zM0 196v188c0 35.3 28.7 64 64 64h384c35.3 0 64-28.7 64-64V196L313.6 344.8c-34.1 25.6-81.1 25.6-115.2 0z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.tabs", "navigation.sections", "navigation.top", "toc.integrate", "content.code.copy", "search.highlight", "search.suggest"], "search": "../../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
    
  </body>
</html>